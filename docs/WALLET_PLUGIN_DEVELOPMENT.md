# XYMPay ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³é–‹ç™ºã‚¬ã‚¤ãƒ‰

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
3. [é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—)
4. [åŸºæœ¬çš„ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä½œæˆ](#åŸºæœ¬çš„ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä½œæˆ)
5. [é«˜åº¦ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ©Ÿèƒ½](#é«˜åº¦ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ©Ÿèƒ½)
6. [ãƒ†ã‚¹ãƒˆã¨ãƒ‡ãƒãƒƒã‚°](#ãƒ†ã‚¹ãƒˆã¨ãƒ‡ãƒãƒƒã‚°)
7. [ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ç™»éŒ²ã¨é…å¸ƒ](#ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ç™»éŒ²ã¨é…å¸ƒ)
8. [ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](#ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹)
9. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

## ğŸ“– æ¦‚è¦

XYMPayã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ã•ã¾ã–ã¾ãªSymbolã‚¦ã‚©ãƒ¬ãƒƒãƒˆã«å¯¾å¿œã—ãŸQRã‚³ãƒ¼ãƒ‰ç”Ÿæˆã¨ãƒ‡ã‚£ãƒ¼ãƒ—ãƒªãƒ³ã‚¯æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚é–‹ç™ºè€…ã¯ç‹¬è‡ªã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½œæˆã—ã¦ã€æ–°ã—ã„ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚„ç‹¬è‡ªã®ä»•æ§˜ã«å¯¾å¿œã§ãã¾ã™ã€‚

### ä¸»ãªæ©Ÿèƒ½

- **QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ**: ã‚¦ã‚©ãƒ¬ãƒƒãƒˆå›ºæœ‰ã®ä»•æ§˜ã«åŸºã¥ãQRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
- **ãƒ‡ã‚£ãƒ¼ãƒ—ãƒªãƒ³ã‚¯**: ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ—ãƒªã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯ç”Ÿæˆ
- **æŸ”è»Ÿãªè¨­å®š**: ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã”ã¨ã®è©³ç´°è¨­å®šã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç®¡ç†**: ç®¡ç†ç”»é¢ã‹ã‚‰ã®æœ‰åŠ¹/ç„¡åŠ¹åˆ‡ã‚Šæ›¿ãˆ
- **ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½**: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®å‹•ä½œç¢ºèªã¨ãƒ‡ãƒãƒƒã‚°

---

## ğŸ—ï¸ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚³ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```
src/lib/symbol/plugins/
â”œâ”€â”€ types.ts           # å‹å®šç¾©
â”œâ”€â”€ manager.ts         # ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
â”œâ”€â”€ symbol-plugins.ts  # æ¨™æº–ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å®Ÿè£…
â””â”€â”€ index.ts          # ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š
```

### ä¸»è¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

```typescript
// QRGeneratorPlugin: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®åŸºæœ¬ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
interface QRGeneratorPlugin {
  id: string;
  name: string;
  version: string;
  description: string;
  wallet: WalletInfo;
  
  canHandle(request: PaymentRequest): boolean;
  generateQR(request: PaymentRequest, options?: QRCodeOptions): Promise<string>;
  generateUri(request: PaymentRequest): string;
  getConfigComponent?(): React.ComponentType<any>;
}
```

---

## ğŸ› ï¸ é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. å¿…è¦ãªä¾å­˜é–¢ä¿‚

```bash
npm install qrcode
npm install @types/qrcode --save-dev
```

### 2. å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª

`src/lib/symbol/plugins/types.ts`ã®å†…å®¹ã‚’ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦æ‹¡å¼µã—ã¾ã™ã€‚

```typescript
export interface PaymentRequest {
  recipientAddress: string;
  amount: number | string;
  paymentId: string;
  currency?: string;
  message?: string;
}

export interface WalletInfo {
  id: string;
  name: string;
  displayName: string;
  description: string;
  icon: string;
  type: 'mobile' | 'desktop' | 'web' | 'hardware';
  supported: boolean;
  downloadUrl?: string;
  deepLinkScheme?: string;
}
```

### 3. é–‹ç™ºç”¨ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆ

```
src/lib/symbol/plugins/
â”œâ”€â”€ custom/
â”‚   â”œâ”€â”€ my-wallet-plugin.ts    # ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
â”‚   â”œâ”€â”€ my-wallet-config.tsx   # è¨­å®šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â””â”€â”€ index.ts              # ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
```

---

## ğŸš€ åŸºæœ¬çš„ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä½œæˆ

### Step 1: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¯ãƒ©ã‚¹ã®ä½œæˆ

```typescript
// src/lib/symbol/plugins/custom/my-wallet-plugin.ts
import QRCode from 'qrcode';
import { QRGeneratorPlugin, PaymentRequest, QRCodeOptions, WalletInfo } from '../types';

export class MyWalletPlugin implements QRGeneratorPlugin {
  readonly id = 'my-wallet';
  readonly name = 'My Wallet Plugin';
  readonly version = '1.0.0';
  readonly description = 'ã‚«ã‚¹ã‚¿ãƒ ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç”¨QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³';

  readonly wallet: WalletInfo = {
    id: 'my-wallet',
    name: 'MyWallet',
    displayName: 'My Custom Wallet',
    description: 'ã‚«ã‚¹ã‚¿ãƒ é–‹ç™ºã•ã‚ŒãŸSymbolã‚¦ã‚©ãƒ¬ãƒƒãƒˆ',
    icon: '/icons/wallets/my-wallet.svg',
    type: 'mobile',
    supported: true,
    downloadUrl: 'https://example.com/my-wallet',
    deepLinkScheme: 'mywallet://'
  };

  /**
   * ã“ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯
   */
  canHandle(request: PaymentRequest): boolean {
    // åŸºæœ¬çš„ãª validation
    return !!(
      request.recipientAddress &&
      request.amount &&
      request.paymentId
    );
  }

  /**
   * QRã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
   */
  async generateQR(request: PaymentRequest, options?: QRCodeOptions): Promise<string> {
    try {
      // URI ã‚’ç”Ÿæˆ
      const uri = this.generateUri(request);
      
      // QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚ªãƒ—ã‚·ãƒ§ãƒ³
      const qrOptions = {
        width: options?.width || 256,
        height: options?.height || 256,
        margin: options?.margin || 4,
        color: {
          dark: options?.color?.dark || '#000000',
          light: options?.color?.light || '#FFFFFF'
        }
      };

      // QRã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
      const qrCodeDataURL = await QRCode.toDataURL(uri, qrOptions);
      return qrCodeDataURL;

    } catch (error) {
      throw new Error(`QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
    }
  }

  /**
   * ãƒ‡ã‚£ãƒ¼ãƒ—ãƒªãƒ³ã‚¯URIã‚’ç”Ÿæˆ
   */
  generateUri(request: PaymentRequest): string {
    // ã‚«ã‚¹ã‚¿ãƒ ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç”¨ã®URIå½¢å¼
    const params = new URLSearchParams({
      address: request.recipientAddress,
      amount: request.amount.toString(),
      message: request.message || request.paymentId,
      payment_id: request.paymentId
    });

    return `${this.wallet.deepLinkScheme}pay?${params.toString()}`;
  }

  /**
   * è¨­å®šç”»é¢ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
   */
  getConfigComponent() {
    return MyWalletConfig; // å¾Œã§ä½œæˆ
  }
}
```

### Step 2: è¨­å®šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä½œæˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

```typescript
// src/lib/symbol/plugins/custom/my-wallet-config.tsx
import React, { useState } from 'react';

interface MyWalletConfigProps {
  settings: any;
  onSettingsChange: (settings: any) => void;
}

export function MyWalletConfig({ settings, onSettingsChange }: MyWalletConfigProps) {
  const [qrSize, setQrSize] = useState(settings?.qrSize || 256);
  const [darkColor, setDarkColor] = useState(settings?.darkColor || '#000000');

  const handleSave = () => {
    onSettingsChange({
      qrSize,
      darkColor
    });
  };

  return (
    <div className="space-y-4">
      <h3 className="text-lg font-medium">My Wallet è¨­å®š</h3>
      
      <div>
        <label className="block text-sm font-medium text-gray-700 mb-2">
          QRã‚³ãƒ¼ãƒ‰ã‚µã‚¤ã‚º
        </label>
        <input
          type="number"
          value={qrSize}
          onChange={(e) => setQrSize(Number(e.target.value))}
          className="border border-gray-300 rounded-md px-3 py-2"
          min="128"
          max="512"
        />
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700 mb-2">
          QRã‚³ãƒ¼ãƒ‰è‰²
        </label>
        <input
          type="color"
          value={darkColor}
          onChange={(e) => setDarkColor(e.target.value)}
          className="border border-gray-300 rounded-md"
        />
      </div>

      <button
        onClick={handleSave}
        className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
      >
        è¨­å®šã‚’ä¿å­˜
      </button>
    </div>
  );
}
```

### Step 3: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ç™»éŒ²

```typescript
// src/lib/symbol/plugins/custom/index.ts
export { MyWalletPlugin } from './my-wallet-plugin';
export { MyWalletConfig } from './my-wallet-config';
```

```typescript
// src/lib/symbol/plugins/index.ts ã«è¿½åŠ 
import { MyWalletPlugin } from './custom';

export function createDefaultPluginManager(): QRPluginManager {
  const manager = new QRPluginManager();

  // æ¨™æº–ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ç™»éŒ²
  manager.registerPlugins([
    new SymbolMobilePlugin(),
    new SymbolDesktopPlugin(),
    new SymbolStandardPlugin(),
    new MyWalletPlugin() // ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è¿½åŠ 
  ]);

  return manager;
}
```

---

## ğŸ”§ é«˜åº¦ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ©Ÿèƒ½

### 1. å‹•çš„è¨­å®šã®å®Ÿè£…

```typescript
export class AdvancedWalletPlugin implements QRGeneratorPlugin {
  // ...åŸºæœ¬ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£...

  async generateQR(request: PaymentRequest, options?: QRCodeOptions): Promise<string> {
    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‹ã‚‰è¨­å®šã‚’å–å¾—
    const settings = this.getSettings();
    
    // è¨­å®šã«åŸºã¥ã„ã¦QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
    const customOptions = {
      ...options,
      width: settings.qrSize || options?.width || 256,
      color: {
        dark: settings.darkColor || '#000000',
        light: settings.lightColor || '#FFFFFF'
      }
    };

    const uri = this.generateUri(request);
    return await QRCode.toDataURL(uri, customOptions);
  }

  private getSettings() {
    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‹ã‚‰è¨­å®šã‚’å–å¾—
    return qrPluginManager.getConfig().pluginSettings[this.id] || {};
  }
}
```

### 2. éåŒæœŸåˆæœŸåŒ–

```typescript
export class AsyncWalletPlugin implements QRGeneratorPlugin {
  private initialized = false;
  private walletConfig: any = null;

  async initialize() {
    if (!this.initialized) {
      // å¤–éƒ¨APIã‹ã‚‰ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæƒ…å ±ã‚’å–å¾—
      this.walletConfig = await fetch('/api/wallet-config').then(r => r.json());
      this.initialized = true;
    }
  }

  async generateQR(request: PaymentRequest, options?: QRCodeOptions): Promise<string> {
    await this.initialize();
    // åˆæœŸåŒ–å¾Œã®å‡¦ç†...
  }
}
```

### 3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```typescript
export class RobustWalletPlugin implements QRGeneratorPlugin {
  async generateQR(request: PaymentRequest, options?: QRCodeOptions): Promise<string> {
    try {
      // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
      this.validateRequest(request);
      
      const uri = this.generateUri(request);
      return await QRCode.toDataURL(uri, options);
      
    } catch (error) {
      // ãƒ­ã‚°å‡ºåŠ›
      console.error(`[${this.id}] QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚¨ãƒ©ãƒ¼:`, error);
      
      // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
      if (error instanceof ValidationError) {
        throw new Error('å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ãŒä¸æ­£ã§ã™ã€‚');
      } else if (error instanceof NetworkError) {
        throw new Error('ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚');
      } else {
        throw new Error('QRã‚³ãƒ¼ãƒ‰ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
      }
    }
  }

  private validateRequest(request: PaymentRequest) {
    if (!request.recipientAddress || request.recipientAddress.length < 39) {
      throw new ValidationError('ç„¡åŠ¹ãªã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã™ã€‚');
    }
    
    if (!request.amount || Number(request.amount) <= 0) {
      throw new ValidationError('ç„¡åŠ¹ãªé‡‘é¡ã§ã™ã€‚');
    }
  }
}

class ValidationError extends Error {}
class NetworkError extends Error {}
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆã¨ãƒ‡ãƒãƒƒã‚°

### 1. ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

```typescript
// src/lib/symbol/plugins/custom/__tests__/my-wallet-plugin.test.ts
import { MyWalletPlugin } from '../my-wallet-plugin';

describe('MyWalletPlugin', () => {
  let plugin: MyWalletPlugin;

  beforeEach(() => {
    plugin = new MyWalletPlugin();
  });

  test('canHandle should return true for valid request', () => {
    const request = {
      recipientAddress: 'TCQNZRRMHBHMHPXJ7HYM6WNBVCJD4Y2E636KJTY',
      amount: 100,
      paymentId: 'TEST1234'
    };

    expect(plugin.canHandle(request)).toBe(true);
  });

  test('generateUri should create valid URI', () => {
    const request = {
      recipientAddress: 'TCQNZRRMHBHMHPXJ7HYM6WNBVCJD4Y2E636KJTY',
      amount: 100,
      paymentId: 'TEST1234',
      message: 'Test payment'
    };

    const uri = plugin.generateUri(request);
    expect(uri).toContain('mywallet://pay');
    expect(uri).toContain('address=TCQNZRRMHBHMHPXJ7HYM6WNBVCJD4Y2E636KJTY');
    expect(uri).toContain('amount=100');
  });

  test('generateQR should return data URL', async () => {
    const request = {
      recipientAddress: 'TCQNZRRMHBHMHPXJ7HYM6WNBVCJD4Y2E636KJTY',
      amount: 100,
      paymentId: 'TEST1234'
    };

    const qrCode = await plugin.generateQR(request);
    expect(qrCode).toMatch(/^data:image\/png;base64,/);
  });
});
```

### 2. çµ±åˆãƒ†ã‚¹ãƒˆ

```typescript
// ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã§ã®ãƒ†ã‚¹ãƒˆ
import { qrPluginManager } from '../index';

describe('Plugin Integration', () => {
  test('plugin should be registered and available', () => {
    const availableWallets = qrPluginManager.getAvailableWallets();
    const myWallet = availableWallets.find(w => w.pluginId === 'my-wallet');
    
    expect(myWallet).toBeDefined();
    expect(myWallet.wallet.displayName).toBe('My Custom Wallet');
  });

  test('plugin test functionality', async () => {
    const result = await qrPluginManager.testPlugin('my-wallet');
    expect(result.success).toBe(true);
  });
});
```

### 3. ãƒ‡ãƒãƒƒã‚°ç”¨ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›

```typescript
export class DebuggableWalletPlugin implements QRGeneratorPlugin {
  private debug = process.env.NODE_ENV === 'development';

  async generateQR(request: PaymentRequest, options?: QRCodeOptions): Promise<string> {
    if (this.debug) {
      console.log(`[${this.id}] QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆé–‹å§‹:`, request);
      console.log(`[${this.id}] ã‚ªãƒ—ã‚·ãƒ§ãƒ³:`, options);
    }

    const uri = this.generateUri(request);
    
    if (this.debug) {
      console.log(`[${this.id}] ç”ŸæˆURI:`, uri);
    }

    const qrCode = await QRCode.toDataURL(uri, options);
    
    if (this.debug) {
      console.log(`[${this.id}] QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆå®Œäº†:`, qrCode.substring(0, 50) + '...');
    }

    return qrCode;
  }
}
```

---

## ğŸ“¦ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ç™»éŒ²ã¨é…å¸ƒ

### 1. ã‚¢ã‚¤ã‚³ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®æº–å‚™

```bash
# ã‚¢ã‚¤ã‚³ãƒ³ã‚’é…ç½®
public/icons/wallets/my-wallet.svg
```

SVGã‚¢ã‚¤ã‚³ãƒ³ã®ä¾‹ï¼š
```svg
<svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
  <rect width="32" height="32" rx="6" fill="#4F46E5"/>
  <path d="M8 12h16v8H8z" fill="white"/>
  <circle cx="20" cy="16" r="1" fill="#4F46E5"/>
</svg>
```

### 2. ç¿»è¨³ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°

```json
// src/lib/i18n/ja.json
{
  "plugins": {
    "wallets": {
      "my-wallet": {
        "name": "My Custom Wallet",
        "description": "ã‚«ã‚¹ã‚¿ãƒ é–‹ç™ºã•ã‚ŒãŸSymbolã‚¦ã‚©ãƒ¬ãƒƒãƒˆ"
      }
    }
  }
}
```

### 3. TypeScriptå‹å®šç¾©ã®æ›´æ–°

```typescript
// å¿…è¦ã«å¿œã˜ã¦ types.ts ã‚’æ‹¡å¼µ
export interface ExtendedWalletInfo extends WalletInfo {
  customSettings?: {
    apiEndpoint?: string;
    apiKey?: string;
    customFields?: Record<string, any>;
  };
}
```

---

## ğŸ’¡ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è¨­è¨ˆåŸå‰‡

- **å˜ä¸€è²¬ä»»**: 1ã¤ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯1ã¤ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®ã¿ã‚’ã‚µãƒãƒ¼ãƒˆ
- **ç–çµåˆ**: ä»–ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚„å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã«ä¾å­˜ã—ãªã„è¨­è¨ˆ
- **ã‚¨ãƒ©ãƒ¼å‡¦ç†**: é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: é‡ã„å‡¦ç†ã¯éåŒæœŸã§å®Ÿè¡Œ

### 2. ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

```typescript
// âœ… è‰¯ã„ä¾‹
export class WellDesignedPlugin implements QRGeneratorPlugin {
  readonly id = 'well-designed';
  readonly name = 'Well Designed Plugin';
  readonly version = '1.0.0';
  
  async generateQR(request: PaymentRequest, options?: QRCodeOptions): Promise<string> {
    this.validateRequest(request);
    const uri = this.generateUri(request);
    return await this.createQRCode(uri, options);
  }
  
  private validateRequest(request: PaymentRequest): void {
    // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†
  }
  
  private async createQRCode(uri: string, options?: QRCodeOptions): Promise<string> {
    // QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆå‡¦ç†
  }
}

// âŒ æ‚ªã„ä¾‹
export class PoorlyDesignedPlugin implements QRGeneratorPlugin {
  id = 'poorly-designed'; // readonlyã‚’ä½¿ç”¨
  
  async generateQR(request: PaymentRequest): Promise<string> {
    // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãªã—
    // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãªã—
    return QRCode.toDataURL(request.recipientAddress); // ä¸é©åˆ‡ãªURI
  }
}
```

### 3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

```typescript
export class SecureWalletPlugin implements QRGeneratorPlugin {
  generateUri(request: PaymentRequest): string {
    // âœ… å…¥åŠ›å€¤ã®ã‚µãƒ‹ã‚¿ã‚¤ã‚º
    const sanitizedAddress = this.sanitizeAddress(request.recipientAddress);
    const sanitizedAmount = this.sanitizeAmount(request.amount);
    const sanitizedMessage = this.sanitizeMessage(request.message);
    
    return `wallet://pay?address=${encodeURIComponent(sanitizedAddress)}&amount=${sanitizedAmount}`;
  }
  
  private sanitizeAddress(address: string): string {
    // ã‚¢ãƒ‰ãƒ¬ã‚¹å½¢å¼ã®æ¤œè¨¼
    if (!/^[A-Z0-9]{39}$/.test(address)) {
      throw new Error('ç„¡åŠ¹ãªã‚¢ãƒ‰ãƒ¬ã‚¹å½¢å¼ã§ã™');
    }
    return address;
  }
  
  private sanitizeAmount(amount: number | string): string {
    const numAmount = Number(amount);
    if (isNaN(numAmount) || numAmount <= 0) {
      throw new Error('ç„¡åŠ¹ãªé‡‘é¡ã§ã™');
    }
    return numAmount.toString();
  }
}
```

---

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒç™»éŒ²ã•ã‚Œãªã„

**ç—‡çŠ¶**: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç®¡ç†ç”»é¢ã«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒè¡¨ç¤ºã•ã‚Œãªã„

**åŸå› ã¨è§£æ±ºæ–¹æ³•**:
```typescript
// âŒ å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰
export function createDefaultPluginManager(): QRPluginManager {
  const manager = new QRPluginManager();
  // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ç™»éŒ²ã—å¿˜ã‚Œ
  return manager;
}

// âœ… ä¿®æ­£å¾Œ
export function createDefaultPluginManager(): QRPluginManager {
  const manager = new QRPluginManager();
  
  manager.registerPlugins([
    new SymbolMobilePlugin(),
    new SymbolDesktopPlugin(),
    new SymbolStandardPlugin(),
    new MyWalletPlugin() // è¿½åŠ 
  ]);
  
  return manager;
}
```

#### 2. QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚¨ãƒ©ãƒ¼: Cannot read property 'toDataURL' of undefined`

**è§£æ±ºæ–¹æ³•**:
```typescript
// QRCodeãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ­£ã—ã„ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import QRCode from 'qrcode';

// éåŒæœŸå‡¦ç†ã®é©åˆ‡ãªå®Ÿè£…
async generateQR(request: PaymentRequest, options?: QRCodeOptions): Promise<string> {
  try {
    const uri = this.generateUri(request);
    const qrCodeDataURL = await QRCode.toDataURL(uri, options);
    return qrCodeDataURL;
  } catch (error) {
    console.error('QRCode generation failed:', error);
    throw new Error(`QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
  }
}
```

#### 3. ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è¨­å®šãŒä¿å­˜ã•ã‚Œãªã„

**ç—‡çŠ¶**: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®æœ‰åŠ¹/ç„¡åŠ¹è¨­å®šãŒä¿æŒã•ã‚Œãªã„

**è§£æ±ºæ–¹æ³•**:
```typescript
// ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç¢ºèª
console.log('Stored config:', localStorage.getItem('xympay_plugin_config'));

// è¨­å®šã®æ‰‹å‹•ä¿å­˜
qrPluginManager.setPluginEnabled('my-wallet', true);

// ãƒ‡ãƒãƒƒã‚°æƒ…å ±ç¢ºèª
qrPluginManager.debugConfig();
```

#### 4. TypeScriptã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `Property 'id' does not exist on type`

**è§£æ±ºæ–¹æ³•**:
```typescript
// ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®æ­£ã—ã„å®Ÿè£…
export class MyWalletPlugin implements QRGeneratorPlugin {
  readonly id = 'my-wallet';           // readonly ã‚’ä½¿ç”¨
  readonly name = 'My Wallet Plugin';  // readonly ã‚’ä½¿ç”¨
  readonly version = '1.0.0';          // readonly ã‚’ä½¿ç”¨
  
  // å¿…é ˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…
  canHandle(request: PaymentRequest): boolean {
    return true;
  }
  
  async generateQR(request: PaymentRequest, options?: QRCodeOptions): Promise<string> {
    // å®Ÿè£…
  }
  
  generateUri(request: PaymentRequest): string {
    // å®Ÿè£…
  }
}
```

---

## ğŸ“š å‚è€ƒãƒªã‚½ãƒ¼ã‚¹

### API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

- [QRGeneratorPlugin Interface](./src/lib/symbol/plugins/types.ts)
- [QRPluginManager Class](./src/lib/symbol/plugins/manager.ts)
- [æ¨™æº–ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å®Ÿè£…ä¾‹](./src/lib/symbol/plugins/symbol-plugins.ts)

### å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

- [qrcode](https://www.npmjs.com/package/qrcode) - QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- [Symbol SDK](https://docs.symbolplatform.com/sdk/) - Symbol SDK ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³

- [Symbol Mobile Plugin](./src/lib/symbol/plugins/symbol-plugins.ts#L1)
- [Symbol Desktop Plugin](./src/lib/symbol/plugins/symbol-plugins.ts#L50)
- [Symbol Standard Plugin](./src/lib/symbol/plugins/symbol-plugins.ts#L100)

---

## ğŸ”„ æ›´æ–°å±¥æ­´

- **v1.0.0** (2025-06-27): åˆç‰ˆãƒªãƒªãƒ¼ã‚¹
  - åŸºæœ¬çš„ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³é–‹ç™ºã‚¬ã‚¤ãƒ‰
  - ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã¨ãƒ†ã‚¹ãƒˆæ–¹æ³•
  - ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³é–‹ç™ºã«é–¢ã™ã‚‹è³ªå•ã‚„ã‚µãƒãƒ¼ãƒˆãŒå¿…è¦ãªå ´åˆã¯ã€ä»¥ä¸‹ã®æ–¹æ³•ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ï¼š

1. **GitHub Issues**: ãƒã‚°å ±å‘Šã‚„æ©Ÿèƒ½è¦æ±‚
2. **é–‹ç™ºè€…å‘ã‘ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: æœ€æ–°ã® API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹
3. **ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ•ã‚©ãƒ¼ãƒ©ãƒ **: é–‹ç™ºè€…åŒå£«ã®æƒ…å ±äº¤æ›

---

**Happy Coding! ğŸš€**
